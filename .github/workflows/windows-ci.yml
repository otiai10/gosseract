name: Windows Test

on:
  workflow_dispatch:
  schedule:
    - cron: '0 0 * * 5'
  push:
    branches: [main, develop, windows/*]
  pull_request:
    branches: [main, develop]

jobs:
  windows-test:
    runs-on: windows-latest
    name: Windows Test
    steps:
    - name: Checkout
      uses: actions/checkout@v3
    - name: Setup Go
      uses: actions/setup-go@v3
      with:
        go-version: 1.18
    - name: Search packages
      run: |
        vcpkg search tesseract
        vcpkg search leptonica
    - name: Install Tesseract
      run: |
        vcpkg install leptonica:x64-windows --head
        vcpkg install tesseract:x64-windows --head
    - name: Check installation
      run: dir C:\vcpkg
    - name: Test Gosseract
      run: go test -v -cover ./...

